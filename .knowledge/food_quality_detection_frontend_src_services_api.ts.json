{"is_source_file": true, "format": "TypeScript", "description": "This file defines types, constants, and functions related to analyzing images for food quality detection. It includes type definitions for analysis results, mock analysis functions, utility functions for handling requests, and an export function for analyzing images via API or mock response.", "external_files": ["none (internal module, no explicit external file references apart from fetch and environment variables)"], "external_methods": ["fetch"], "published": ["Indicator", "AnalysisResult", "AnalyzeResponse", "analyzeImage"], "classes": [], "methods": [{"name": "function getBase(): string { getBase", "description": "Returns the API base URL from environment variable VITE_API_BASE.", "scope": "", "scopeKind": ""}, {"name": "export function isMockMode(): boolean { isMockMode", "description": "Determines if the system is running in mock mode (when VITE_API_BASE is not set).", "scope": "", "scopeKind": ""}, {"name": "function withTimeout<T>(promise: Promise<T>, ms = DEFAULT_TIMEOUT_MS, controller?: AbortControll/ withTimeout", "description": "Wraps a promise with a timeout, aborting if it exceeds the specified duration.", "scope": "", "scopeKind": ""}, {"name": "function buildFormData(file: File): FormData { buildFormData", "description": "Creates FormData containing the provided file.", "scope": "", "scopeKind": ""}, {"name": "function mockAnalyze(file: File): Promise<AnalyzeResponse> { mockAnalyze", "description": "Generates a simulated analysis response based on file size for testing.", "scope": "", "scopeKind": ""}, {"name": "analyzeImage", "description": "Main exported function to analyze an image file, sending it to API or returning a mocked response."}], "calls": ["fetch"], "search-terms": ["analyzeImage", "Indicator", "AnalysisResult", "mockAnalyze", "VITE_API_BASE"], "state": 2, "file_id": 19, "knowledge_revision": 47, "git_revision": "", "revision_history": [{"46": ""}, {"47": ""}], "ctags": [{"_type": "tag", "name": "AnalysisResult", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^export type AnalysisResult = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "AnalyzeResponse", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^export type AnalyzeResponse =$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "DEFAULT_TIMEOUT_MS", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^const DEFAULT_TIMEOUT_MS = 20000$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "Indicator", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^export type Indicator = { name: string; value: number; unit?: string }$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "buildFormData", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^function buildFormData(file: File): FormData {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "confidence", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const confidence = Math.min(0.95, 0.5 + ((size % 1000) \\/ 1000) * 0.45)$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "const", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const idx = size % 3$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "fd", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const fd = new FormData()$/", "language": "TypeScript", "kind": "constant", "scope": "buildFormData", "scopeKind": "function"}, {"_type": "tag", "name": "getBase", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^function getBase(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const idx = size % 3$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "indicators", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const indicators = [$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "isMockMode", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^export function isMockMode(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mockAnalyze", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^function mockAnalyze(file: File): Promise<AnalyzeResponse> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "qualities", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const qualities: AnalysisResult['quality'][] = ['Fresh', 'Stale', 'Spoiled']$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "size", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const size = file.size$/", "language": "TypeScript", "kind": "constant", "scope": "mockAnalyze", "scopeKind": "function"}, {"_type": "tag", "name": "timeout", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^  const timeout = new Promise<never>((_, reject) => {$/", "language": "TypeScript", "kind": "constant", "scope": "withTimeout", "scopeKind": "function"}, {"_type": "tag", "name": "withTimeout", "path": "/home/kavia/workspace/code-generation/food-quality-detection-system-42065-42074/food_quality_detection_frontend/src/services/api.ts", "pattern": "/^function withTimeout<T>(promise: Promise<T>, ms = DEFAULT_TIMEOUT_MS, controller?: AbortControll/", "language": "TypeScript", "kind": "function"}], "hash": "24615e1805b73826a622d5deee431c11", "format-version": 4, "code-base-name": "food_quality_detection_frontend", "filename": "food_quality_detection_frontend/src/services/api.ts"}